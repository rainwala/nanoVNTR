import pytest
from nano_vntr import nanoVNTR

nv = nanoVNTR('CGAGTCCCTCAAGTCCTTC','CAACAGCCGCCACCGCCGCC','CAG',0.75,0.9,1)

## define test methods
def test_get_matches():
    assert nv.get_matches('ACCCCTTTTCTGCCAGGCACGGCGCCAGGCTCGATCACGCTCTCGTGCCCTCCGCTTTCAGCGGGTGGCCTCAGTCCTCACCACGCTATTTCTTCGCGCTTCGCGTATTGCCCACCTTCCCGCAGAGCCCTCGCGGTTCCCCTGCAGGGCTGTTCGCGGAGAGTGGTTTCACGGGTCAGTGTGGCGGGAAAACCTCAGCACATCTCGGCTCAGAGTTCACGGTGCCGGCTGTCTTCGCTTCCAGGCAGTCGGTGGGTATTCTTCGTGGCTGGGCCTCGCGCCCGCGCTCGGCGCCTCCACGGCCCCGCCCCGTCCATGGCCCCGTCCTTCATGGGCGGGCTTCTCCATGGCCCTGCCCCTCCGCGCTCCCACCTCCCTCGCCCCACCTTCACCTTCCTGCCCTGCCTCAGCCTCCCACCCTCACTGGCTGGGCCCCTCTCTATCCTGCCTGCCCTCAGCTGCCCTGCCCTCAGCTGGCCTGCCTCCACGTCCCGTCCCCAGCATCACCCTGCCCTCTGCCCCTCTGTCTCGCTCCCCGCCCCTCAGGGCGGCCCTCCCTGCTGTGTCTCGGCCCCGGCCCTGCCACGCCCCCATCTCCCCACCACGCCCCGCATCACACACTGCACCGCCACGCCTCCCCTACCATGCAGTCCCGCCCTGTCCCTTCCTCGTCCTGCCTTGCCATGACTTCACACAGTTTGCCCCCACCCCATTACAGTCTCACCACGCCCCCGTCCTCTCCGCCTCCTGCGCCTCTGCCTGCCAGGCTGTCACAGCCCTTGTTGTGTGAGGCAGACTGCGGGGTGCAGGGTGGCTGGACCCTGGCCAGCCATTGGCAGAGTCCGCAGGCTGGCTGACCCATGTTGACAGTGTGGTCTCTGCTCTCCAGCCGGGAGTGGTCTGCCTCCGCTGGCGCAGCGTCTGGGACGCAAGGCGCCGGGGCTGCCGGGACGGTCCAAGATGGACGGCCGCTCAGGTTCTGCTTTTACCTGCGGCCCAGAGCCCCTTTCATTGCCCCGGTGCTGAGCGGTGCCGCGAGTCAGGTCTGGAGGCCCCGGGACCGCCGTGCCGGGCGGGCGGCGACCCTGAAAGCTGATGAAGGGCCTTCGAGTCCCTCAAGTCCTTCCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGTAGCAACAGCCGCCACCGCCGCTGCCGCCGCCGCCATTCGCCGCCTCCTCAGCTTCAGCCGCTGCCAGAGGTGGCACAGCCGCCAGCACCTCAGCCGCAGTTGCCCTGCTGTGCCAAATCCCGCCGCCACAGCTGGGCCGGTGGCGGCGGGGGCGGCGGCGGGCGGCTGCGGCTAAGGCAGCAGTGGCCAGCCTGCGGCGGCGGCTGAGGAAGCGAGGAGGCGGCGGCGGCGGCGGCGGCGGCGGCGGCGGTGGCGGCTGTTGCTGCTGCTGCTGCTGCTGTTGCCAAGCGTTGCTGCTGCTGCTGCTGCTGGAAGGACTTGAGGACCCGAAGGCCTTCATCAGCTTTCCAGGGTCGCTGGCGGTTCCCCGCCCGGCACGGCAGTCCTCCCGGAGGCTCCGCCGACTCCGCGGCGCCAGCACCGGGCAATGAATGGGGCTCTGGGCCGCAGGTAAAAGCAGAACCCGAGCGGCCGTCCATTTTGGACCTGTCCCGGCAGCCCCTCACGGCGCCTGTCCCAGACCGCCAGCCGGCGGAGGCGGGGCCGCGCTGCGGAGGCGTAGCCACGCCGGCCAGCATGATTGATGTAGCCCCAGCTCCGCGGATCCTGCCAATGGCTGGCCAGGGAACCAGCTCCGCCCCTGCCCCCTGCAGGTTCTGGCCCACACAGCAAGGCCGCTGACAGCGCAGGCGCCCCACCCGGCGCGGGCCTAACGGGAGAGGGACGGCGGTGAGACTGTAATGGGGTGATGAAGCAGAAGTGTCATGAGGCGGGACGAGTGAAGGGACGGGGCGGGACTGCATGGTAGTGGAGGAAGGATAAAAGGGATGGAGGAAGGAGGAATAGTGGAATGGGGCCCGAGGGGTGGAAGGATGGACAAATGGAAGGGATCAATGGTGGAGGCTGGGGTGGCGGAGGGGTGGGGCCGGAAGGAATGGACGGGTGGCCGAGTGGAAAGGATGCCCGCCGGATCGCCCGGAGTGGACAGCCGAGGTGGTCTTGCCCAAGACTGGAAGCCAGAGCCATACTCTCACCTGGACAGGCCCTGGTGGGAGCCAGCTGCGGCCTCTTGCACGGGGAGAGGGTGGCGAGGCCTGCGCAGAGCGAGAATGCGGGTCGGCCGACCTGAGGACCCTGCGTGGCTCCCCCACCCCACCCCAGTGAGCTGGGAGGCCCTGCGGGCGGTGTCCACAGGCCTGGCGCCCCATCGGTCCCAGCGCAGCGCCCCGGAAGGAGGAGGGTCTGGGGCAGGCTTGGGTGGTCAGCGCCCGCCGCTCCAGCCACAGAGGCACTGTGATTAGTGCAGCGAGAAGCAGCTATGGCCACAAGATGCCGCCCACAGGAATGAGTCCCGACCTGGGGCGTTTCTTTATGGGAGTGCACCCTGCAATATCAGCACCAAATAAGAAAGGTTAACACAAAGACACCGACAACTTCTTCAGCACCACAGCAATACGTGCAACTGAACGAAGCATACCGAGTTTTTGGGAA','CGAGTCCCTCAAGTCCTTC',0.75) == {1107: 'CGAGTCCCTCAAGTCCTTC'}

def test_get_region_rep_count():
    assert nv.get_region_rep_count('CAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGCAGTAG','CAG',0.9) == 15

def test_get_alleles_from_fastq_file():
    nv.get_read_records_from_file('test_reads.fq','fastq')
    nv.multiprocess_read_repeats(1)
    rep_counts = nv.convert_read_repeat_dict_to_repeat_count_list()
    assert nv.get_VNTR_alleles(rep_counts,'centroid') == [17.0, 50.0]


